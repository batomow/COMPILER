[gd_scene load_steps=12 format=2]

[ext_resource path="res://Scripts/Game.tres.gd" type="Script" id=1]
[ext_resource path="res://Art/BG.jpg" type="Texture" id=2]
[ext_resource path="res://Art/tuberia.png" type="Texture" id=3]
[ext_resource path="res://Art/piso_agua.png" type="Texture" id=4]
[ext_resource path="res://Main Scenes/Game/Valvula.tscn" type="PackedScene" id=5]
[ext_resource path="res://Main Scenes/Game/InGameMenu.tscn" type="PackedScene" id=6]
[ext_resource path="res://Main Scenes/Game/RiskMeter.tscn" type="PackedScene" id=7]
[ext_resource path="res://Main Scenes/Game/CharacterFace.tscn" type="PackedScene" id=8]
[ext_resource path="res://Main Scenes/Game/Reloj.tscn" type="PackedScene" id=9]
[ext_resource path="res://Main Scenes/Game/Toolbox.tscn" type="PackedScene" id=10]

[sub_resource type="GDScript" id=1]
resource_name = "Tabla Spawner"
script/source = "extends Node

var Tabla = preload(\"res://Main Scenes/Game/Tabla.tscn\")
onready var spawns = self.get_children()
onready var queue = range(0, spawns.size())
onready var container = self.get_node(\"../Tablas Container\")
onready var timer:Timer = self.get_node(\"../Tabla Timer\")

func _init(): 
	GM.connect(\"game_paused\", self, \"_on_paused\")
	GM.connect(\"game_unpaused\", self, \"_on_unpaused\")

func _ready():
	queue.shuffle()

func _on_Timer_timeout():
	if not queue.empty(): 
		var new_tabla = Tabla.instance()
		new_tabla.position = spawns[queue.front()].position
		container.add_child(new_tabla)
		queue.pop_front()
	else: 
		queue = range(0, spawns.size())
		queue.shuffle()

func _on_unpaused(): 
	timer.paused = false

func _on_paused(): 
	timer.paused = true
"

[node name="Game" type="Node2D"]
script = ExtResource( 1 )

[node name="Pipe" type="Node2D" parent="."]
editor/display_folded = true

[node name="Line" type="Line2D" parent="Pipe"]
points = PoolVector2Array( 214, 150, 264.117, 149.504, 331.132, 148.84, 389.485, 148.263, 486.232, 147.305, 551.037, 146.663, 653.181, 145.652, 719, 145, 715.862, 172.054, 710.266, 209.472, 706, 238, 668.836, 234.345, 620.249, 229.565, 571.661, 224.786, 523, 220, 519, 184, 475.974, 185.14, 418.679, 186.658, 368, 188, 363, 239, 318.341, 240.999, 248.508, 244.124, 211.158, 245.795, 209.713, 278.465, 207.104, 337.464, 205.436, 375.193, 228.783, 376.304, 297.863, 379.594, 300.266, 347.148, 302.748, 313.644, 304.905, 284.526, 332.774, 286.557, 384.714, 290.342, 413.616, 292.449, 414.81, 261.395, 416.257, 223.789, 443.211, 231.897, 470.392, 240.074, 469.71, 265.335, 468.871, 296.373, 468.192, 321.497, 447.654, 322.252, 414.936, 323.453, 385.849, 324.522, 360.361, 325.458, 365.66, 353.436, 371.364, 383.555, 398.024, 383.683, 432.42, 383.849, 462.91, 383.995, 473.739, 363.55, 487.799, 337.005, 503.02, 308.268, 517.926, 280.125, 544.559, 278.192, 572.502, 276.164, 571.976, 304.172, 571.36, 336.934, 570.741, 369.911, 556.721, 397.128, 543.373, 423.043, 512.798, 424.055, 423.022, 427.023, 374.145, 428.64, 317.646, 430.508, 260.974, 432.382, 210.637, 434.047, 217.012, 460.257, 222.52, 482.901, 268.189, 481.32, 312.041, 479.802, 353.915, 478.352, 403.537, 476.635, 450.685, 475.003, 497.059, 473.397, 535.083, 472.081, 565.819, 471.017, 580.972, 443.538, 595.83, 416.593, 610.179, 390.573, 624.796, 364.066, 701.818, 343.821, 699.407, 375.268, 697.043, 406.089, 694.164, 443.636, 691.255, 481.58, 736.168, 481.804, 779.72, 482.02, 779.72, 448.979, 779.72, 403.488, 779.72, 361.602, 779.72, 325.335, 750.144, 320.215, 702.283, 311.928, 667.1, 305.837, 632.278, 299.808, 625.676, 268.999, 668.739, 271.343, 713.895, 273.8, 771.738, 276.948, 819.772, 279.562 )
texture_mode = -1082452802

[node name="Background" type="TextureRect" parent="."]
anchor_right = 1.0
anchor_bottom = 1.0
margin_right = 1920.0
margin_bottom = 1080.0
rect_scale = Vector2( 0.563, 0.667 )
mouse_filter = 2
texture = ExtResource( 2 )

[node name="Background2" type="TextureRect" parent="."]
anchor_right = 1.0
anchor_bottom = 1.0
margin_left = 151.0
margin_top = 90.0
margin_right = 1339.0
margin_bottom = 766.0
rect_scale = Vector2( 0.58, 0.6 )
texture = ExtResource( 3 )

[node name="Midground" type="TextureRect" parent="."]
anchor_right = 1.0
anchor_bottom = 1.0
margin_left = 2.0
margin_top = -1.0
margin_right = 1986.0
margin_bottom = 1079.0
rect_scale = Vector2( 0.563, 0.667 )
mouse_filter = 2
texture = ExtResource( 4 )

[node name="EarlyGame" type="Timer" parent="."]
wait_time = 3.0
one_shot = true

[node name="MidGame" type="Timer" parent="."]
wait_time = 35.0
one_shot = true

[node name="LateGame" type="Timer" parent="."]
wait_time = 20.0
one_shot = true

[node name="Leak" type="Timer" parent="."]

[node name="FugaContainer" type="Node2D" parent="."]
pause_mode = 1

[node name="Tablas Spawner" type="Node" parent="."]
editor/display_folded = true
script = SubResource( 1 )

[node name="Position2D" type="Position2D" parent="Tablas Spawner"]
position = Vector2( 152.904, -65.0603 )

[node name="Position2D2" type="Position2D" parent="Tablas Spawner"]
position = Vector2( 291.889, -64.1578 )

[node name="Position2D3" type="Position2D" parent="Tablas Spawner"]
position = Vector2( 431.776, -65.9628 )

[node name="Position2D4" type="Position2D" parent="Tablas Spawner"]
position = Vector2( 568.054, -66.8653 )

[node name="Position2D5" type="Position2D" parent="Tablas Spawner"]
position = Vector2( 695.307, -70.4753 )

[node name="Position2D6" type="Position2D" parent="Tablas Spawner"]
position = Vector2( 813.534, -67.7678 )

[node name="Position2D7" type="Position2D" parent="Tablas Spawner"]
position = Vector2( 938.982, -69.5728 )

[node name="Tablas Container" type="Node" parent="."]

[node name="Tabla Timer" type="Timer" parent="."]
wait_time = 2.0
autostart = true

[node name="Valvula" parent="." instance=ExtResource( 5 )]
position = Vector2( 937.08, 628.769 )

[node name="UI" type="CanvasLayer" parent="."]
editor/display_folded = true
layer = 2

[node name="InGameMenu" parent="UI" instance=ExtResource( 6 )]
margin_right = -1080.0
margin_bottom = -720.0

[node name="RiskMeter" parent="UI" instance=ExtResource( 7 )]
margin_left = 755.0
margin_top = 621.0
margin_right = -57.0
margin_bottom = 231.0
rect_scale = Vector2( 0.25, 0.25 )

[node name="CharacterFace" parent="UI" instance=ExtResource( 8 )]
margin_left = 640.0
margin_top = 574.284
margin_right = 640.0
margin_bottom = 574.284

[node name="Reloj" parent="UI" instance=ExtResource( 9 )]
margin_left = 104.132
margin_top = -1.29236
margin_right = 104.132
margin_bottom = -1.29236

[node name="Toolbox" parent="UI" instance=ExtResource( 10 )]
margin_left = 1.0
margin_right = -1079.0
margin_bottom = -720.0
[connection signal="timeout" from="EarlyGame" to="." method="_on_EarlyGame_timeout"]
[connection signal="timeout" from="MidGame" to="." method="_on_MidGame_timeout"]
[connection signal="timeout" from="LateGame" to="." method="_on_LateGame_timeout"]
[connection signal="timeout" from="Leak" to="." method="_on_Leak_timeout"]
[connection signal="timeout" from="Tabla Timer" to="Tablas Spawner" method="_on_Timer_timeout"]
