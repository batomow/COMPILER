[gd_scene load_steps=6 format=2]

[ext_resource path="res://Art/valvula.png" type="Texture" id=1]
[ext_resource path="res://Art/rosca valvula.png" type="Texture" id=2]

[sub_resource type="GDScript" id=3]
script/source = "extends Node2D

var radious:float = 0
var velocity := Vector2()
var pressed := false
onready var rosca = $Rosca

func _on_Rosca_input_event(viewport, event, shape_idx):
	if event is InputEventMouse: 
		if event is InputEventMouseButton: 
			if event.button_index == 1: 
				radious = (viewport.get_mouse_position() - position).length() / 90
			if event.pressed: 
				pressed = true
			else: 
				pressed = false
		elif event is InputEventMouseMotion and pressed: 
			velocity = event.relative.normalized() * event.speed
			rosca.angular_velocity = (velocity.length() * radious)
	
func _process(delta):
	if Input.is_action_just_released(\"left_mouse_button\"): 
		pressed = false
		rosca.angular_velocity = 0
"

[sub_resource type="RectangleShape2D" id=1]
extents = Vector2( 169.08, 14.5655 )

[sub_resource type="CircleShape2D" id=2]
radius = 88.4985

[node name="Valvula" type="Node2D"]
position = Vector2( 351.073, 168.768 )
script = SubResource( 3 )

[node name="Tubo" type="StaticBody2D" parent="."]

[node name="Sprite2D" type="Sprite" parent="Tubo"]
position = Vector2( 0, 46.7141 )
texture = ExtResource( 1 )

[node name="CollisionShape2D" type="CollisionShape2D" parent="Tubo"]
shape = SubResource( 1 )

[node name="PinJoint2D" type="PinJoint2D" parent="."]
position = Vector2( -4.08784, 9.34364 )
node_a = NodePath("../Tubo")
node_b = NodePath("../Rosca")

[node name="Rosca" type="RigidBody2D" parent="."]
input_pickable = true
gravity_scale = 0.0

[node name="Sprite2D" type="Sprite" parent="Rosca"]
texture = ExtResource( 2 )

[node name="CollisionShape2D" type="CollisionShape2D" parent="Rosca"]
shape = SubResource( 2 )
[connection signal="input_event" from="Rosca" to="." method="_on_Rosca_input_event"]
